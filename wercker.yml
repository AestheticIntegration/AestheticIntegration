box: jekyll/jekyll:3.6.2
  username: $DOCKER_HUB_USERNAME
  password: $DOCKER_HUB_PASSWORD

build:
  steps:
    - script:
        name: build
        code: |
          set -ex
          git submodule update --init --recursive
          bundle install
          cp jekyll-resources/rouge-lexers/ipl.rb /usr/local/bundle/gems/rouge-2.2.1/lib/rouge/lexers/ipl.rb
          mkdir _site
          JEKYLL_ENV=production jekyll build

deploy:
  steps:
    - hijonathan/gh-pages@0.2.3:
        basedir: _site
        token: $GITHUB_TOKEN
        branch: master
        domain: docs.imandra.ai
